import concurrent.futures
from functools import reduce

data = """
math	physics	english	IS	Stats	python	IT	Traninig	English 2	Programming Ai	Basics	negotiaton skills	human rigths	digital desgin	OS	Training 2
Hours	3	3	2	2	1	2	2	1	2	2	1	1	2	3	3	2
احمد امير سليم عبد المطلب	90	90	49	62	31	50	77	30	81	55	82	25	28	73	95	60
احمد امين عبد النبى امين	150	150	80	81	50	80	85	45	95	98	98	35	32	140	130	90
احمد ايهاب حسين صقر	135	135	74	66	43	65	78	45	90	65	65	26	28	120	95	85
احمد ثابت احمد مصطفى ثابت	95	133	92	94	43	76	91	30	99	82	83	37	35	116	125	60
احمد زكى جبر الشافعى	113	120	66	80	41	74	86	40	92	75	75	36	35	95	96	80
احمد عادل سيد محمد الوسيمي	90	115	52	82	30	28	92	30	91	76	42	31	32	105	114	60
احمد محمد رمضان السيد	140	150	94	86	50	94	94	43	92	99	100	44	34	129	129	85
احمد ناصر الدين احمد العيسوى	130	150	90	80	47	82	86	43	99	99	97	30	34	137	134	85
احمد وليد عبد الغفار عبد الوهاب الديب	86	147	85	86	50	96	94	46	99	96	99	40	34	123	139	90
اسراء محمد محمد ماهر على إبراهيم	140	145	90	72	50	78	66	40	94	90	82	30	29	103	119	80
امل مجدى محمود متولى ابراهيم	90	102	70	62	45	64	77	38	92	90	60	30	34	90	95	75
امنيه عرفه محمد عرفه	146	149	64	76	48	68	67	43	89	86	54	29	33	133	122	85
ايه محمد عبد الجليل عبده السوداني	90	99	50	60	37	62	76	30	92	58	70	25	27	90	96	60
جهاد سميح سعيد ابو فاطمه	95	117	68	52	44	35	64	43	88	60	60	25	25	97	90	85
جون سامى جورج سلامه	108	142	78	76	48	80	92	38	91	73	69	34	37	106	106	75
رنا محمد فاروق عبدالقادر ماضي	90	142	74	62	50	66	71	43	90	88	60	30	28	95	95	65
روان احمد محمد حسن	112	141	58	66	28	68	78	42	93	80	87	25	27	89	113	85
زياد السيد ابراهيم الدسوقى محمد حسن	92	104	70	62	42	80	69	43	92	88	94	25	25	90	90	85
زياد سيد محمد احمد علي	102	124	76	65	44	80	73	43	89	76	83	25	35	127	112	85
زياد شريف محسن حنفي	90	105	60	60	33	56	63	45	91	65	79	25	26	101	91	90
زينب مصطفى عبد النعيم عباس	133	143	50	68	48	58	62	30	91	78	98	26	30	105	104	60
شريف يسري ابراهيم على	91	102	70	62	30	68	76	30	88	59	90	25	35	90	90	60
شمس احمد عبد الحميد محمد موسى	124	146	84	67	44	84	62	30	91	78	82	25	35	113	107	75
عمر امين جابر ابراهيم	150	133	60	60	48	82	75	40	87	91	74	25	29	89	98	86
عمر هانى صابر الصغير محمد	122	133	64	72	49	85	78	45	94	91	89	34	39	92	114	90
عمرو بلال السعيد عبد الرحمن عرب	150	141	78	62	43	90	84	39	93	93	85	31	36	129	121	77
غاده احمد الامير محمود حمد الله	117	136	84	64	46	78	76	30	89	82	70	32	29	110	110	60
فاطمه مجدى محمود متولى ابراهيم	90	94	60	60	38	66	74	38	83	77	71	31	33	107	101	75
كيرلس عياد لبيب اسكندر	120	130	80	72	48	92	84	40	84	91	81	32	37	80	104	80
محمد احمد سعيد محمد نوير	147	150	86	70	50	74	64	43	94	95	81	34	25	107	109	85
محمد احمد محمد عبد العزيز عبد الحليم	135	131	70	56	46	92	90	45	94	98	87	35	44	128	121	80
محمد جمال محمد إبراهيم	118	119	68	66	38	80	78	43	99	80	72	35	28	99	104	85
محمد خالد حسين محمد عيسى	127	130	58	68	40	84	88	40	85	93	75	30	30	112	104	80
محمد عبد الله يوسف عبد الله	127	141	96	76	40	80	88	43	95	83	75	30	38	99	122	85
محمد عماد ابراهيم بسيونى محمد	107	124	64	70	42	74	82	39	79	93	78	28	25	90	103	77
محمد عمرو محمد كامل	130	148	80	74	50	90	83	45	96	94	92	38	39	134	128	90
محمد وحيد فرج الله محمود محمد	103	135	76	62	49	82	80	36	89	77	81	25	27	90	106	75
مروه احمد عبد الدايم شحاته	150	150	72	70	46	92	78	43	97	96	90	37	37	129	127	85
مصطفي ابراهيم صفوت الرشاش	114	107	78	64	36	88	80	45	89	82	60	27	32	99	97	90
مصعب محمد عبد الغنى احمد	113	120	54	64	46	92	88	39	90	78	68	34	33	88	98	77
ملك محمد عبد الحميد محمد عبد الحمبد	137	150	90	80	48	94	92	43	97	95	89	36	33	137	117	85
منه الله تامر محمد مسلم عمر	118	132	56	60	45	70	83	40	90	91	77	27	31	90	90	80
ناجى عبد الجابر نادى عبد الجابر	120	128	50	60	39	72	76	43	87	90	86	32	34	91	100	85
نورا محمود عبد الحكيم مرسى	146	150	52	60	46	62	64	43	89	89	60	29	25	117	92	85
هدير سمير موسى محمد عوض	119	102	56	60	37	60	76	40	87	84	60	35	37	90	102	80
هنا هانى فتحي على	133	150	72	66	47	82	80	40	95	96	85	35	37	110	109	80
يوسف سليم عامر سليم	126	127	70	72	36	80	88	40	93	85	59	38	27	90	101	80
يوسف عبد الجابر نادى عبد الجابر	139	150	74	66	39	86	89	45	74	95	96	39	38	112	113	90
"""

hours = [3, 3, 2, 2, 1, 2, 2, 1, 2, 2, 1, 1, 2, 3, 3, 2]

lines = data.strip().split('\n')

def calculate_gpa(grades, hours):
    total_points = reduce(lambda acc, x: acc + x[0] * x[1], zip(grades, hours), 0)
    
    max_points = reduce(lambda acc, hour: acc + 120* hour, hours, 0)  # باستخدام الحد الأقصى لكل مادة كـ 100
    
    gpa = (total_points / max_points) * 4
    
    if gpa > 4:
        gpa = 4.0
    elif gpa < 0:
        gpa = 0.0
    
    return gpa

def process_student(line):
    parts = line.split('\t')
    name = parts[0]
    grades = list(map(int, filter(lambda x: x.strip().isdigit(), parts[1:])))
    gpa = calculate_gpa(grades, hours)
    return (name, gpa)

with concurrent.futures.ThreadPoolExecutor() as executor:
    results = list(executor.map(process_student, lines))

sorted_results = sorted(results, key=lambda x: x[1], reverse=True)

for name, gpa in sorted_results:
    print(f"{name}: {gpa:.2f}")